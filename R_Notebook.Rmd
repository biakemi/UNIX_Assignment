---
title: "R Assignment"
output: html_notebook
---
Setting the directory
```{r}
setwd("~/Desktop/BioDataSkillsClass/UNIX_Assignment")
```

Loading files to R

```{r}
fang <- read.table("fang_et_al_genotypes.txt", header = TRUE )
position <- read.table("snp_position.txt", header = TRUE, fill = TRUE)
```

Data Inspection
```{r}
str(fang)
str(position)
dim(fang)
dim(position)
nrow(fang)
nrow(position)
ncol(fang)
ncol(position)

head(fang, n = 1)
head(position, n = 3)
```

Data processing

Subset unnecessary columns
```{r}
fang_subset <- subset(fang, select = -c(1:2))
```

Extracting maize and teosinte data
```{r}
maize <- c("ZMMIL","ZMMLR","ZMMMR")
maize_extracted <- fang_subset[fang_subset$Group %in% maize,]

teosinte <- c("ZMPBA", "ZMPIL", "ZMPJA")
teosinte_extracted <- fang_subset[fang_subset$Group %in% teosinte,]
```

Transpose the data
```{r}
maize_transposed <- as.data.frame(t(maize_extracted[,-1]))

teosinte_transposed <- as.data.frame(t(teosinte_extracted[,-1]))
```

Subset columns of snp_position file that matter
```{r}
position_subset <- subset(position, select = c(1,3,4))
```

Sort files
```{r}
maize_sorted <- maize_transposed[order(row.names(maize_transposed)),]
teosinte_sorted <- teosinte_transposed[order(row.names(teosinte_transposed)),]
position_sorted <- position_subset[order(position_subset$SNP_ID),]
```

Remove data from "unknown and random" chromosomes in SNP position file
```{r}
chromosome <- c(1,2,3,4,5,6,7,8,9,10)
position_sorted_selected <- position_sorted %>% filter(Chromosome %in% chromosome)
position_sorted <- position_sorted_selected[-1,]
```

group by chromosome = group_by(Chromsome)
function reshape - for the second part of the homework